<div class="popup-container">
  <!-- STATUS + PLUS BUTTON -->
  <div class="filter-item">
    <div class="status-wrapper">
      <h3 class="filters-title">STATUS</h3>
      <label class="switch">
        <input
          type="checkbox"
          [checked]="data?.status === 'ACTIVE'"
          (change)="onStatusToggle($event)"
        />
        <span class="slider round"></span>
      </label>
    </div>

    <!-- + Button -->
    <button class="plus-btn" *ngIf="isActive" (click)="openPopup(data)">
      +
    </button>

    <!-- Popup -->
    <div class="popup-menu" *ngIf="showPopup">
      <button class="popup-item" (click)="openSection('camera')">
        <img src="assets/cam.svg" alt="Site & Camera" class="nav-icon" />
        Site & Camera
      </button>
      <button class="popup-item" (click)="openSection('employee')">
        <img src="assets/moniter.svg" alt="Employee" class="nav-icon" />
        Employee
      </button>
    </div>
  </div>

  <!-- ===================== SITE INFO ===================== -->
  <div class="report-header">
    <h2>SITE INFO</h2>
  </div>

  <!-- Header row (like screenshot) -->
  <div class="site-header">
    <div class="site-id-col">SITE ID</div>
    <div class="site-name-col">SITE NAME</div>
    <div class="camera-count-col">CAMERA'S</div>
    <div class="site-action-col"></div>
  </div>

  <!-- Site + Camera rows / empty state -->
  <div class="site-list">
    <!-- When we have sites -->
    <ng-container *ngIf="sitesDisplay && sitesDisplay.length; else noSitesTpl">
      <div class="site-block" *ngFor="let site of sitesDisplay">
        <!-- main site row -->
        <div class="site-row" (click)="toggleSiteExpand(site)">
          <div class="site-id-col site-id-cell">
            <span class="chevron">
              <img
                src="assets/down-arrow.png"
                class="arrow-icon"
                [class.expanded]="site.expanded"
              />
            </span>
            <span class="site-id-text">{{ site.siteId }}</span>
          </div>

          <div class="site-name-col site-name-cell">
            <span class="site-name-text">{{ site.siteName }}</span>
          </div>

          <div class="camera-count-col site-camera-count">
            {{ site.queueCamerasCount }} / {{ site.totalCamerasCount }}
          </div>

          <div class="site-action-col">
            <button class="delete-btn" (click)="onSiteDelete(site, $event)">
              ✕
            </button>
          </div>
        </div>

        <!-- child cameras -->
        <div class="camera-list" *ngIf="site.expanded && site.cameras.length">
          <div class="camera-row" *ngFor="let cam of site.cameras">
            <div class="site-id-col"></div>

            <div class="site-name-col camera-name-cell">
              {{ cam.cameraId }} - {{ cam.cameraName }}
            </div>

            <div class="camera-count-col"></div>

            <div class="site-action-col">
              <button
                class="camera-delete-btn"
                (click)="onCameraDelete(site, cam, $event)"
              >
                ✕
              </button>
            </div>
          </div>
        </div>
      </div>
    </ng-container>

    <!-- When NO sites -->
    <ng-template #noSitesTpl>
      <div class="empty-row">
        No sites available
      </div>
    </ng-template>
  </div>

  <!-- ===================== EMPLOYEE INFO ===================== -->
  <div class="report-header" style="margin-top: 20px">
    <h2>EMPLOYEE INFO</h2>
  </div>

  <div class="employee-list">
    <!-- When we have employees -->
    <ng-container *ngIf="usersDisplay && usersDisplay.length; else noEmployeesTpl">
      <div class="employee-row" *ngFor="let user of usersDisplay">
        <div class="employee-main">
          <div class="user-info">
            <img
              class="user-img"
              [src]="user.profileImage || 'assets/user1.png'"
              [alt]="user.User_Name || 'User'"
            />

            <div class="user-text">
              <div class="emp-name">
                {{ user.User_Name || "EMP NAME" }}
              </div>
              <div class="emp-id">
                {{ user.userId || "ID" }}
              </div>
            </div>
          </div>

          <button
            class="delete-btn"
            *ngIf="(user.status || '').toLowerCase() === 'active'"
            (click)="onUserDelete(user)"
          >
            ✕
          </button>
        </div>
      </div>
    </ng-container>

    <!-- When NO employees -->
    <ng-template #noEmployeesTpl>
      <div class="empty-row">
        No employees available
      </div>
    </ng-template>
  </div>
</div>
