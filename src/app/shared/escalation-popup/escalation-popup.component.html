<div class="popup-container">
  <div class="section">
    <!-- BASIC INFO -->
    <div class="basic-info" *ngIf="selectedEvent">
      <h2>BASIC INFO</h2>
      <div class="info-table">
        <div class="row" *ngFor="let info of basicInfoFields">
          <div class="label">{{ info.label }}</div>
          <div class="colon">:</div>
          <div class="value">
            <span
              *ngIf="info.field === 'eventType'"
              class="dot"
              [ngStyle]="{
                'background-color': getEventDotColor(selectedEvent[info.field])
              }"
            ></span>

            <ng-container
              *ngIf="info.label.toLowerCase().includes('time'); else normalValue"
            >
              {{
                selectedEvent[info.field]
                  ? formatDateTime(selectedEvent[info.field])
                  : info.default || "--"
              }}
            </ng-container>

            <ng-template #normalValue>
              {{ selectedEvent[info.field] || info.default || "--" }}
            </ng-template>
          </div>
        </div>
      </div>
    </div>

    <!-- ALARM EVENTS (AG Grid) -->
    <div class="alarm-events">
      <h2>ALARM EVENTS ON</h2>
      <ag-grid-angular
        style="width: 100%"
        theme="legacy"
        class="ag-theme-alpine"
        [rowData]="alarmRowData"
        [columnDefs]="alarmColumnDefs"
        [defaultColDef]="defaultColDef"
        [enableCellTextSelection]="true"
        [enableRangeSelection]="true"
        [copyHeadersToClipboard]="true"
        [pagination]="true"
        [paginationPageSize]="3"
        [paginationPageSizeSelector]="[3, 20, 50, 100]"
        (gridReady)="onGridReady($event)"
        style="width: 100%; height: 250px"
      ></ag-grid-angular>
    </div>
  </div>

  <!-- DURATION -->
  <div class="total-duration" *ngIf="selectedEvent">
    <span *ngIf="selectedEvent.eventDuration">
      TOTAL DURATION : {{ selectedEvent.eventDuration }}
    </span>
    <span>INDIA {{ "00:00:00" }}</span>
    <span>US {{ "00:00:00" }}</span>
  </div>

  <div class="div">
    <p class="borderline"></p>
  </div>



  <!-- ======================= ESCALATION REPORT ======================= -->
  <div class="report-header">
    <h2>ESCALATION REPORT</h2>

    <div class="timezone">
      <label>
        <input
          type="radio"
          name="tz"
          value="CT"
          [(ngModel)]="selectedTZ"
          (change)="onTzChange(selectedTZ)"
        />
        CT
      </label>

      <label>
        <input
          type="radio"
          name="tz"
          value="MT"
          [(ngModel)]="selectedTZ"
          (change)="onTzChange(selectedTZ)"
          checked
        />
        Customer TZ (MT)
      </label>

      <label>
        <input
          type="radio"
          name="tz"
          value="IST"
          [(ngModel)]="selectedTZ"
          (change)="onTzChange(selectedTZ)"
        />
        IST
      </label>
    </div>
  </div>

  <div class="div">
    <p class="borderline"></p>
  </div>

  <!-- Escalation AG Grid -->
  <ag-grid-angular
    style="width: 100%"
    theme="legacy"
    class="ag-theme-alpine"
    [rowData]="escalationRowData"
    [columnDefs]="escalationColumnDefs"
    [defaultColDef]="{ resizable: true }"
    [pagination]="true"
    [enableCellTextSelection]="true"
    [enableRangeSelection]="true"
    [copyHeadersToClipboard]="true"
    [paginationPageSize]="3"
    [paginationPageSizeSelector]="[3, 20, 50, 100]"
    domLayout="autoHeight"
    (gridReady)="onGridReady($event)"
  >
  </ag-grid-angular>

  <!-- ======================= COMMENTS ======================= -->
  <div class="report-header">
    <h2>Comments</h2>
    <div class="timezone">
      <p-button class="today-btn" (onClick)="addComments()"> + ADD </p-button>
    </div>
  </div>

  <div class="div">
    <p class="borderline"></p>
  </div>

  <ag-grid-angular
    #commentGrid
    style="width: 100%"
    theme="legacy"
    class="ag-theme-alpine"
    [rowData]="commentRowData"
    [columnDefs]="commentColumnDefs"
    [defaultColDef]="{ resizable: true }"
    [pagination]="true"
    [paginationPageSize]="3"
    [enableCellTextSelection]="true"
    [enableRangeSelection]="true"
    [copyHeadersToClipboard]="true"
    [paginationPageSizeSelector]="[3, 20, 50, 100]"
    domLayout="autoHeight"
    (gridReady)="onCommentGridReady($event)"
  >
  </ag-grid-angular>
</div>
